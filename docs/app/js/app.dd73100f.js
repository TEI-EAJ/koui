(function(t){function e(e){for(var n,i,o=e[0],l=e[1],c=e[2],p=0,h=[];p<o.length;p++)i=o[p],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&h.push(r[i][0]),r[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(h.length)h.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==r[l]&&(n=!1)}n&&(s.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},r={app:0},s=[];function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var n=a("19b3"),r=a.n(n);r.a},1:function(t,e){},"19b3":function(t,e,a){},2:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-content",[a("v-toolbar",{attrs:{dark:!0,flat:""}},[a("v-toolbar-title",[t._v("校本風異文可視化ツール")]),a("v-spacer"),a("v-btn",{attrs:{icon:"",href:"./"}},[a("v-icon",[t._v("mdi-home")])],1)],1),a("v-container",{directives:[{name:"show",rawName:"v-show",value:!t.start,expression:"!start"}],staticClass:"my-5"},[a("h2",{staticClass:"mb-5"},[t._v("校本風異文可視化ツール")]),a("p",[t._v("異文情報を含むTEI/XMLファイルを選択してください。")]),a("input",{attrs:{type:"file",id:"files",multiple:""},on:{change:t.handleFileSelect}}),a("output",{staticClass:"mt-5",attrs:{id:"list"}}),a("br"),a("br"),a("br"),a("p",{staticClass:"mt-5"},[t._v("例１：校異源氏物語")]),a("v-btn",{staticClass:"mx-2",attrs:{color:"primary",to:"/?u=01_with_wit.xml"}},[t._v("可視化例を見る")]),a("v-btn",{staticClass:"mx-2",attrs:{href:"01_with_wit.xml",target:"_blank"}},[t._v("サンプルデータを見る")]),a("br"),a("p",{staticClass:"mt-5"},[t._v("例２：ダミーデータ")]),a("v-btn",{staticClass:"mx-2",attrs:{color:"primary",to:"/?u=https://nakamura196.github.io/tei/v-machine/data/nakamura.xml"}},[t._v("可視化例を見る")]),a("v-btn",{staticClass:"mx-2",attrs:{href:"https://nakamura196.github.io/tei/v-machine/data/nakamura.xml",target:"_blank"}},[t._v("サンプルデータを見る")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.start,expression:"start"}],style:"height: "+t.height+"px;"},[a("splitpanes",{staticClass:"default-theme"},[a("pane",{attrs:{"min-size":"20"}},[a("iframe",{staticClass:"py-2 px-2",staticStyle:{border:"none"},attrs:{src:t.mirador_path,seamless:"seamless",width:"100%",height:t.height+"px",allow:"fullscreen"}})]),a("pane",[a("splitpanes",{staticClass:"default-theme",attrs:{horizontal:"horizontal"}},[a("pane",{staticClass:"py-2 mx-2"},[a("v-card",{staticClass:"scroll vertical",attrs:{flat:!0,id:"main"}},[a("v-card-text",{staticClass:"mx-2 text--primary"},[a("h2",{staticClass:"text--primary"},[t._v("本文")]),a("br"),t._l(t.test_arr,(function(e,n){return a("p",{key:n},t._l(e,(function(e,n){return a("span",{key:n},["zone"==e.type?[a("p",{on:{click:function(a){return t.clickIcon(e.id)}}},[a("img",{staticClass:"mr-2",staticStyle:{width:"30px"},attrs:{src:"https://iiif.dl.itc.u-tokyo.ac.jp/images/iiif.png"}})])]:t._e(),"text"==e.type?[t._v(t._s(e.text))]:t._e(),"app"==e.type?[a("span",{staticStyle:{"background-color":"yellow"},on:{click:function(a){return t.test(e.app,e.id,e.index)}}},[a("span",{staticStyle:{color:"red"}},[t._v(t._s(e.index))]),t._v(" "+t._s(e.text)+" ")])]:t._e()],2)})),0)}))],2)],1)],1),a("pane",{staticClass:"py-2 mx-2"},[a("v-card",{staticClass:"scroll vertical",attrs:{flat:!0,id:"sub"}},[a("v-list-item",[a("v-card-text",{staticClass:"mx-2 text--primary"},[a("h2",{staticClass:"text--primary ml-4"},[t._v("異文")]),a("p",[a("b",[t._v("Witness List")]),a("br"),t._l(t.witness,(function(e,n){return a("span",{key:n,staticClass:"mr-2"},[t._v(" "+t._s(n)+" ")])}))],2),a("br"),t._l(t.test5,(function(e,n){return a("v-card",{key:n,staticClass:"mx-5"},[a("v-card-text",{staticClass:"mx-2 text--primary"},[a("span",{on:{click:function(e){return t.close_panel(n)}}},[a("i",{staticClass:"fas fa-times-circle"})]),a("span",{staticClass:"mt-2",staticStyle:{color:"red"}},[t._v(t._s(e.index))]),a("br"),t._l(e.wits,(function(e,n){return a("p",{key:n},["lem"==e.type?[t._v(t._s(e.text)+" （"+t._s(n)+"）")]:[a("b",[t._v(t._s(e.text)+" （"+t._s(n)+"）")])]],2)}))],2)],1)}))],2)],1)],1)],1)],1)],1)],1)],1)],1)],1)},s=[],i=(a("b0c0"),a("a9e3"),a("512e")),o=a("bc3a"),l=a.n(o),c="mirador/",u=a("c51a"),p={components:{Splitpanes:i["Splitpanes"],Pane:i["Pane"]},data:function(){return{width:window.innerWidth,height:window.innerHeight,url_main:"",data_main:[],data_main_e:[],mirador_path:"",direction:"vertical",layout:"1x1",test_arr:[],test4:{},test5:{},witness:{},test_map:{},start:!1,xmlDoc:null}},watch:{$route:function(){this.init()}},mounted:function(){this.init()},methods:{init:function(){window.addEventListener("resize",this.handleResize);var t=null==this.$route.query.u?null:this.$route.query.u;t&&this.exec2main(t)},conv2json:function(t){t=(new XMLSerializer).serializeToString(t);var e=u.xml2json(t,{compact:!1,spaces:4}),a=JSON.parse(e);return a=a.elements[0],a},clickIcon:function(t){var e=this.test_map[t],a=[{manifest:e.manifest,canvas:e.canvas}];this.mirador_path=c+"?params="+encodeURIComponent(JSON.stringify(a))+"&annotationState=on&layout="+this.layout},handleResize:function(){this.width=window.innerWidth,this.height=window.innerHeight},rec:function(t,e){for(var a=0;a<t.length;a++){var n=t[a];if(e.push(n),n.elements&&"app"!=n.name){var r=n.elements;e=this.rec(r,e)}}return e},handleFileSelect:function(t){for(var e=t.target.files,a=0;a<e.length;a++){var n=e[a],r=new FileReader;r.readAsText(n);var s=this;r.onload=function(){var t=new DOMParser,e=t.parseFromString(r.result,"text/xml");s.handleXml(e)}}},exec2main:function(t){var e=this;l.a.get(t,{responseType:"document"}).then((function(t){var a=t.data;e.handleXml(a)}))},handleXml:function(t){var e=t.querySelector("listWit");if(e=this.conv2json(e).elements,e.length>0){this.start=!0;for(var a=0;a<e.length;a++){var n=e[a];this.witness["#"+n.attributes["xml:id"]]=n.attributes["xml:id"]}var r=t.querySelector("surfaceGrp");if(null!=r){r=this.conv2json(r);for(var s=r.attributes.facs,i=r.elements,o=0;o<i.length;o++)for(var l=i[o].elements,u=l[0].attributes.n,p=1;p<l.length;p++){var h=l[p].attributes,f=h["xml:id"],m=Number(h["ulx"]),v=Number(h["uly"]),d=Number(h["lrx"])-m,b=Number(h["lry"])-v;this.test_map["#"+f]={manifest:s,canvas:u+"#xywh="+m+","+v+","+d+","+b}}var y=[{manifest:s}];this.mirador_path=c+"?params="+encodeURIComponent(JSON.stringify(y))+"&annotationState=on&layout="+this.layout}var _=t.querySelector("body");_=this.conv2json(_).elements;for(var x=this.rec(_,[]),w=[],g=[],C=1,S=0;S<x.length;S++){var k=x[S],j=k.name,O=k.type;if("lb"==j||"p"==j||"l"==j)w.push(g),g=[];else if("text"==O)g.push(k);else if("pb"==j)g.push({id:k.attributes.facs,type:"zone"});else if("app"==j){var z=k.elements,T=z[0],V="";T.elements&&(V=T.elements[0].text),g.push({text:V,type:"app",app:z,id:"app_"+S,index:C}),C+=1}}w.push(g),this.test_arr=w}else this.start=!1},close_panel:function(t){var e={};for(var a in this.test5)e[a]=this.test5[a];delete e[t],this.test5=e},test:function(t,e,a){var n={};for(var r in this.test5)n[r]=this.test5[r];if(n[e])delete n[e];else{for(var s={},i=0;i<t.length;i++){var o=t[i],l=o.elements,c="";if(o.attributes&&(c=o.attributes.wit),null!=l)for(var u=0;u<l.length;u++){var p=l[u];""!=c&&(s[c]={text:p.text,type:o.name})}}n[e]={index:a,wits:s}}this.test5=n}},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)}},h=p,f=(a("034f"),a("2877")),m=a("6544"),v=a.n(m),d=a("7496"),b=a("8336"),y=a("b0af"),_=a("99d9"),x=a("a523"),w=a("a75b"),g=a("132d"),C=a("da13"),S=a("2fa4"),k=a("71d9"),j=a("2a7f"),O=Object(f["a"])(h,r,s,!1,null,null,null),z=O.exports;v()(O,{VApp:d["a"],VBtn:b["a"],VCard:y["a"],VCardText:_["a"],VContainer:x["a"],VContent:w["a"],VIcon:g["a"],VListItem:C["a"],VSpacer:S["a"],VToolbar:k["a"],VToolbarTitle:j["a"]});var T=a("8c4f");n["a"].use(T["a"]);var V=[{path:"/",name:"index"}],P=new T["a"]({base:"",routes:V,scrollBehavior:function(){return{x:0,y:0}}}),N=P,I=a("f309");n["a"].use(I["a"]);var M=new I["a"]({}),L=a("c4e8"),R=a.n(L);n["a"].use(R.a),n["a"].config.productionTip=!1,new n["a"]({router:N,vuetify:M,render:function(t){return t(z)}}).$mount("#app")}});
//# sourceMappingURL=app.dd73100f.js.map