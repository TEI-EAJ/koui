(function(t){function e(e){for(var n,s,o=e[0],l=e[1],c=e[2],p=0,f=[];p<o.length;p++)s=o[p],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&f.push(r[s][0]),r[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(f.length)f.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==r[l]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},r={app:0},i=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var n=a("19b3"),r=a.n(n);r.a},1:function(t,e){},"19b3":function(t,e,a){},2:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-content",[a("v-toolbar",{attrs:{dark:!0,flat:""}},[a("v-toolbar-title",[t._v("校本風異文可視化ツール")]),a("v-spacer")],1),a("div",{style:"height: "+t.height+"px;"},[a("splitpanes",{staticClass:"default-theme"},[a("pane",{attrs:{"min-size":"20"}},[a("iframe",{staticClass:"py-2 px-2",staticStyle:{border:"none"},attrs:{src:t.mirador_path,seamless:"seamless",width:"100%",height:t.height+"px",allow:"fullscreen"}})]),a("pane",[a("splitpanes",{staticClass:"default-theme",attrs:{horizontal:"horizontal"}},[a("pane",{staticClass:"py-2 mx-2"},[a("v-card",{staticClass:"scroll vertical",attrs:{flat:!0,id:"main"}},[a("v-card-text",{staticClass:"mx-2 text--primary"},[a("h2",{staticClass:"text--primary"},[t._v("本文")]),a("br"),t._l(t.test_arr,(function(e,n){return a("p",{key:n},t._l(e,(function(e,n){return a("span",{key:n},["zone"==e.type?[a("p",{on:{click:function(a){return t.clickIcon(e.id)}}},[a("img",{staticClass:"mr-2",staticStyle:{width:"30px"},attrs:{src:"https://iiif.dl.itc.u-tokyo.ac.jp/images/iiif.png"}})])]:t._e(),"text"==e.type?[t._v(t._s(e.text))]:t._e(),"app"==e.type?[a("span",{staticStyle:{"background-color":"yellow"},on:{click:function(a){return t.test(e.app,e.id,e.index)}}},[a("span",{staticStyle:{color:"red"}},[t._v(t._s(e.index))]),t._v(" "+t._s(e.text)+" ")])]:t._e()],2)})),0)}))],2)],1)],1),a("pane",{staticClass:"py-2 mx-2"},[a("v-card",{staticClass:"scroll vertical",attrs:{flat:!0,id:"sub"}},[a("v-list-item",[a("v-card-text",{staticClass:"mx-2 text--primary"},[a("h2",{staticClass:"text--primary"},[t._v("異文")]),a("br"),t._l(t.test5,(function(e,n){return a("v-card",{key:n,staticClass:"mx-5"},[a("v-card-text",{staticClass:"mx-2 text--primary"},[a("span",{on:{click:function(e){return t.close_panel(n)}}},[a("i",{staticClass:"fas fa-times-circle"})]),a("span",{staticClass:"mt-2",staticStyle:{color:"red"}},[t._v(t._s(e.index))]),a("br"),t._l(e.wits,(function(e,n){return a("p",{key:n},["lem"==e.type?[t._v(t._s(e.text)+" （"+t._s(n)+"）")]:[a("b",[t._v(t._s(e.text)+" （"+t._s(n)+"）")])]],2)}))],2)],1)}))],2)],1)],1)],1)],1)],1)],1)],1)],1)],1)},i=[],s=(a("b0c0"),a("a9e3"),a("512e")),o=a("bc3a"),l=a.n(o),c="mirador/",u=a("c51a"),p={components:{Splitpanes:s["Splitpanes"],Pane:s["Pane"]},data:function(){return{width:window.innerWidth,height:window.innerHeight,url_main:"",data_main:[],data_main_e:[],mirador_path:"",direction:"vertical",layout:"1x1",test_arr:[],test4:{},test5:{},witness:{},test_map:{}}},mounted:function(){window.addEventListener("resize",this.handleResize);var t=null==this.$route.query.u?"01_with_wit.xml":this.$route.query.u;this.exec2main(t)},methods:{conv2json:function(t){t=(new XMLSerializer).serializeToString(t);var e=u.xml2json(t,{compact:!1,spaces:4}),a=JSON.parse(e);return a=a.elements[0],a},clickIcon:function(t){var e=this.test_map[t],a=[{manifest:e.manifest,canvas:e.canvas}];this.mirador_path=c+"?params="+encodeURIComponent(JSON.stringify(a))+"&annotationState=on&layout="+this.layout},handleResize:function(){this.width=window.innerWidth,this.height=window.innerHeight},exec2main:function(t){var e=this;l.a.get(t,{responseType:"document"}).then((function(t){var a=t.data,n=a.querySelector("listWit");n=e.conv2json(n).elements;for(var r=0;r<n.length;r++){var i=n[r];e.witness["#"+i.attributes["xml:id"]]=i.attributes["xml:id"]}var s=[],o=[],l=a.querySelector("surfaceGrp");if(null!=l){l=e.conv2json(l);for(var p=l.attributes.facs,f=l.elements,d=0;d<f.length;d++)for(var m=f[d].elements,h=m[0].attributes.n,v=1;v<m.length;v++){var y=m[v].attributes,x=y["xml:id"],b=Number(y["ulx"]),_=Number(y["uly"]),w=Number(y["lrx"])-b,g=Number(y["lry"])-_;e.test_map["#"+x]={manifest:p,canvas:h+"#xywh="+b+","+_+","+w+","+g}}var S=[{manifest:p}];e.mirador_path=c+"?params="+encodeURIComponent(JSON.stringify(S))+"&annotationState=on&layout="+e.layout}a=(new XMLSerializer).serializeToString(a);for(var C=u.xml2json(a,{compact:!1,spaces:4}),j=JSON.parse(C),O=1,k=j.elements[0].elements[2].elements[0].elements[0],z=k.elements,T=0;T<z.length;T++){var P=z[T],N=P.name,V=P.type;if("app"==N){var J=P.elements,M=J[0],I="";M.elements&&(I=M.elements[0].text),o.push({text:I,type:"app",app:J,id:"app_"+T,index:O}),O+=1}else"text"==V?o.push({text:P.text,type:"text"}):"lb"==N?(s.push(o),o=[]):"pb"==N&&o.push({id:P.attributes.facs,type:"zone"})}e.test_arr=s}))},close_panel:function(t){var e={};for(var a in this.test5)e[a]=this.test5[a];delete e[t],this.test5=e},test:function(t,e,a){var n={};for(var r in this.test5)n[r]=this.test5[r];if(n[e])delete n[e];else{for(var i={},s=0;s<t.length;s++){var o=t[s],l=o.elements,c="";if(o.attributes&&(c=o.attributes.wit),null!=l)for(var u=0;u<l.length;u++){var p=l[u];""!=c&&(i[c]={text:p.text,type:o.name})}}n[e]={index:a,wits:i}}this.test5=n}},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)}},f=p,d=(a("034f"),a("2877")),m=a("6544"),h=a.n(m),v=a("7496"),y=a("b0af"),x=a("99d9"),b=a("a75b"),_=a("da13"),w=a("2fa4"),g=a("71d9"),S=a("2a7f"),C=Object(d["a"])(f,r,i,!1,null,null,null),j=C.exports;h()(C,{VApp:v["a"],VCard:y["a"],VCardText:x["a"],VContent:b["a"],VListItem:_["a"],VSpacer:w["a"],VToolbar:g["a"],VToolbarTitle:S["a"]});var O=a("8c4f");n["a"].use(O["a"]);var k=[{path:"/",name:"index"}],z=new O["a"]({base:"",routes:k,scrollBehavior:function(){return{x:0,y:0}}}),T=z,P=a("f309");n["a"].use(P["a"]);var N=new P["a"]({}),V=a("c4e8"),J=a.n(V);n["a"].use(J.a),n["a"].config.productionTip=!1,new n["a"]({router:T,vuetify:N,render:function(t){return t(j)}}).$mount("#app")}});
//# sourceMappingURL=app.52367a33.js.map