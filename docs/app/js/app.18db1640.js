(function(t){function e(e){for(var r,s,l=e[0],o=e[1],c=e[2],p=0,h=[];p<l.length;p++)s=l[p],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&h.push(n[s][0]),n[s]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);u&&u(e);while(h.length)h.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],r=!0,l=1;l<a.length;l++){var o=a[l];0!==n[o]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=a[0]))}return t}var r={},n={app:0},i=[];function s(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=r,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(a,r,function(e){return t[e]}.bind(null,r));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=o;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var r=a("8a23"),n=a.n(r);n.a},1:function(t,e){},2:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-content",[a("v-toolbar",{attrs:{dark:!0,flat:""}},[a("v-toolbar-title",[t._v("校本風異文可視化ツール")]),a("v-spacer"),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.start,expression:"start"}],attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.dialog_table=!0}}},[a("v-icon",[t._v("mdi-table")])],1),a("v-btn",{attrs:{icon:"",href:"./"}},[a("v-icon",[t._v("mdi-home")])],1)],1),a("v-container",{directives:[{name:"show",rawName:"v-show",value:!t.start,expression:"!start"}],staticClass:"my-5"},[a("h2",{staticClass:"mb-5"},[t._v("校本風異文可視化ツール")]),a("p",[t._v("異文情報を含むTEI/XMLファイルを選択してください。")]),a("input",{attrs:{type:"file",id:"files",multiple:""},on:{change:t.handleFileSelect}}),a("output",{staticClass:"mt-5",attrs:{id:"list"}}),a("br"),a("br"),a("br"),a("p",{staticClass:"mt-5"},[t._v("例１：校異源氏物語")]),a("v-btn",{staticClass:"mx-2",attrs:{color:"primary",to:"/?u=01_with_wit.xml"}},[t._v("可視化例を見る")]),a("v-btn",{staticClass:"mx-2",attrs:{href:"01_with_wit.xml",target:"_blank"}},[t._v("サンプルデータを見る")]),a("br"),a("br"),a("p",{staticClass:"mt-5"},[t._v("例２：（ダミーデータ）中村式五十音")]),a("v-btn",{staticClass:"mx-2",attrs:{color:"primary",to:"/?u=https://nakamura196.github.io/tei/v-machine/data/nakamura.xml"}},[t._v("可視化例を見る")]),a("v-btn",{staticClass:"mx-2",attrs:{href:"https://nakamura196.github.io/tei/v-machine/data/nakamura.xml",target:"_blank"}},[t._v("サンプルデータを見る")]),a("br"),a("br"),a("p",{staticClass:"mt-5"},[t._v("例３：Emily Dickinson ‘Faith is a fine invention’ from "),a("a",{attrs:{href:"http://v-machine.org/samples/"}},[t._v("Versioning Machine")])]),a("v-btn",{staticClass:"mx-2",attrs:{color:"primary",to:"/?u=faith.xml"}},[t._v("可視化例を見る")]),a("v-btn",{staticClass:"mx-2",attrs:{href:"http://v-machine.org/samples/faith.xml",target:"_blank"}},[t._v("サンプルデータを見る")]),a("br"),a("br"),a("br"),a("hr"),a("br"),a("p",{staticClass:"text-center my-5"},[a("a",{attrs:{href:"https://github.com/TEI-EAJ"}},[t._v("TEI-C東アジア/日本語分科会")])])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.start,expression:"start"}],style:"height: "+t.height+"px;"},[a("splitpanes",{staticClass:"default-theme"},[a("pane",[a("iframe",{staticClass:"py-2 px-2",staticStyle:{border:"none"},attrs:{src:t.mirador_path,seamless:"seamless",width:"100%",height:t.height+"px",allow:"fullscreen"}})]),a("pane",[a("splitpanes",{staticClass:"default-theme",attrs:{horizontal:"horizontal"}},[a("pane",{staticClass:"py-2 mx-2"},[a("v-card",{staticClass:"scroll vertical",attrs:{flat:!0,id:"main"}},[a("v-card-text",{staticClass:"mx-2 text--primary"},[a("h2",{staticClass:"text--primary"},[t._v(" 本文 "),t.target?a("span",[t._v(t._s(t.target))]):t._e()]),a("br"),t._l(t.test_arr,(function(e,r){return a("p",{key:r},t._l(e,(function(e,r){return a("span",{key:r},["zone"==e.type?[a("p",{on:{click:function(a){return t.clickIcon(e.id)}}},[a("img",{staticClass:"mr-2",staticStyle:{width:"30px"},attrs:{src:"https://iiif.dl.itc.u-tokyo.ac.jp/images/iiif.png"}})])]:t._e(),"text"==e.type?[t._v(t._s(e.text))]:t._e(),"app"==e.type?[a("span",{staticStyle:{"background-color":"yellow"},on:{click:function(a){return t.test(e.app,e.id,e.index)}}},[a("span",{staticStyle:{color:"red"}},[t._v(" "+t._s(e.index)+" ")]),null==t.target?[t._v(t._s(e.text))]:[t._l(e.app,(function(e,r){return[null!=e.attributes&&-1!=e.attributes.wit.indexOf(t.target)?a("span",{key:r},t._l(e.elements,(function(e,r){return a("span",{key:r},[t._v(t._s(e.text))])})),0):t._e()]}))]],2)]:t._e()],2)})),0)}))],2)],1)],1),a("pane",{staticClass:"py-2 mx-2"},[a("v-card",{staticClass:"scroll vertical",attrs:{flat:!0,id:"sub"}},[a("v-list-item",[a("v-card-text",{staticClass:"mx-2 text--primary"},[a("h2",{staticClass:"text--primary ml-4"},[t._v("異文")]),a("p",[a("b",{on:{click:function(e){t.target=null}}},[t._v("Witness List")]),a("v-sheet",{attrs:{color:"grey lighten-3 px-2 py-2 mx-2"}},t._l(t.witness,(function(e,r){return a("span",{key:r,staticClass:"mr-2 mb-2",on:{click:function(e){t.target=r}}},[t._v(t._s(r))])})),0)],1),a("a",{on:{click:function(e){t.test5={}}}},[t._v("Clear Panel")]),a("br"),t._l(t.test5,(function(e,r){return a("v-card",{key:r,staticClass:"mx-5"},[a("v-card-text",{staticClass:"mx-2 text--primary"},[a("span",{on:{click:function(e){return t.close_panel(r)}}},[a("i",{staticClass:"fas fa-times-circle"})]),a("span",{staticClass:"mt-2",staticStyle:{color:"red"}},[t._v(t._s(e.index))]),a("br"),t._l(e.wits,(function(e,r){return a("p",{key:r},["lem"==e.type?[t._v(t._s(e.text)+" （"+t._s(r)+"）")]:[a("b",[t._v(t._s(e.text)+" （"+t._s(r)+"）")])]],2)}))],2)],1)}))],2)],1)],1)],1)],1)],1)],1)],1),a("v-dialog",{attrs:{width:"600px"},model:{value:t.dialog_table,callback:function(e){t.dialog_table=e},expression:"dialog_table"}},[a("v-container",t._l(t.test6,(function(e,r){return a("div",{key:r,staticClass:"my-5"},[a("v-card",[a("v-card-text",[a("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[t._v("Winess")]),a("th",{staticClass:"text-left"},[t._v("index")]),a("th",{staticClass:"text-left"},[t._v("相違点")])])]),a("tbody",t._l(e.wits,(function(r,n){return a("tr",{key:n},[a("td",{attrs:{width:"40%"}},[t._v(t._s(n))]),a("td",{attrs:{width:"20%"}},[t._v(t._s(e.index))]),a("td",{attrs:{width:"40%"}},[t._v(t._s(r.text))])])})),0)]},proxy:!0}],null,!0)})],1)],1)],1)})),0)],1)],1)],1)},i=[],s=(a("c975"),a("a15b"),a("b0c0"),a("a9e3"),a("1276"),a("512e")),l=a("bc3a"),o=a.n(l),c="mirador/",u=a("c51a"),p={components:{Splitpanes:s["Splitpanes"],Pane:s["Pane"]},data:function(){return{width:window.innerWidth,height:window.innerHeight,url_main:"",data_main:[],data_main_e:[],mirador_path:"",direction:"vertical",layout:"1x1",test_arr:[],test4:{},test5:{},witness:{},test_map:{},start:!1,xmlDoc:null,target:null,test6:{},dialog_table:!1}},watch:{$route:function(){this.init()},target:function(){this.list()}},mounted:function(){this.init()},methods:{list:function(){for(var t={},e=1,a=this.test_arr,r=0;r<a.length;r++)for(var n=a[r],i=0;i<n.length;i++){var s=n[i];if("app"==s.type){for(var l=s.app,o={},c=!1,u=0;u<l.length;u++){var p=l[u],h=p.elements,f="";if(p.attributes&&(f=p.attributes.wit),-1!=f.split(" ").indexOf(this.target)&&(c=!0),null!=h)for(var v=0;v<h.length;v++){var m=h[v];""!=f&&(o[f]={text:m.text,type:p.name})}}c&&(t[s.id]={index:e,wits:o}),e+=1}}this.test5=t},init:function(){window.addEventListener("resize",this.handleResize);var t=null==this.$route.query.u?null:this.$route.query.u;t&&this.exec2main(t)},conv2json:function(t){t=(new XMLSerializer).serializeToString(t);var e=u.xml2json(t,{compact:!1,spaces:4}),a=JSON.parse(e);return a=a.elements[0],a},clickIcon:function(t){var e=this.test_map[t],a=[{manifest:e.manifest,canvas:e.canvas}];this.mirador_path=c+"?params="+encodeURIComponent(JSON.stringify(a))+"&annotationState=on&layout="+this.layout},handleResize:function(){this.width=window.innerWidth,this.height=window.innerHeight},rec:function(t,e){for(var a=0;a<t.length;a++){var r=t[a];if(e.push(r),r.elements&&"app"!=r.name){var n=r.elements;e=this.rec(n,e)}}return e},handleFileSelect:function(t){for(var e=t.target.files,a=0;a<e.length;a++){var r=e[a],n=new FileReader;n.readAsText(r);var i=this;n.onload=function(){var t=new DOMParser,e=t.parseFromString(n.result,"text/xml");i.handleXml(e)}}},exec2main:function(t){var e=this;o.a.get(t,{responseType:"document"}).then((function(t){var a=t.data;e.handleXml(a)}))},handleXml:function(t){var e=t.querySelector("listWit");if(e=this.conv2json(e).elements,e.length>0){this.start=!0;for(var a=0;a<e.length;a++){var r=e[a];this.witness["#"+r.attributes["xml:id"]]=r.attributes["xml:id"]}var n=t.querySelector("surfaceGrp");if(null!=n){n=this.conv2json(n);for(var i=n.attributes.facs,s=n.elements,l=0;l<s.length;l++)for(var o=s[l].elements,u=o[0].attributes.n,p=1;p<o.length;p++){var h=o[p].attributes,f=h["xml:id"],v=Number(h["ulx"]),m=Number(h["uly"]),d=Number(h["lrx"])-v,b=Number(h["lry"])-m;this.test_map["#"+f]={manifest:i,canvas:u+"#xywh="+v+","+m+","+d+","+b}}var _=[{manifest:i}];this.mirador_path=c+"?params="+encodeURIComponent(JSON.stringify(_))+"&annotationState=on&layout="+this.layout}var x=t.querySelector("body");x=this.conv2json(x).elements;for(var y=this.rec(x,[]),g=[],w=[],C=1,k=0;k<y.length;k++){var S=y[k],O=S.name,j=S.type;if("lb"==O||"p"==O||"l"==O)g.push(w),w=[];else if("text"==j)w.push(S);else if("pb"==O)w.push({id:S.attributes.facs,type:"zone"});else if("app"==O){var V=S.elements;if("lem"==V[0].name){for(var T=[],P=0;P<V.length;P++)if(V[P].attributes)for(var z=V[P].attributes.wit.split(" "),N=0;N<z.length;N++){var I=z[N];-1==T.indexOf(I)&&T.push(I)}V[0].attributes||(V[0].attributes={});var E=[];for(var M in V[0].attributes.wit&&(E=V[0].attributes.wit.split(" ")),this.witness)-1==T.indexOf(M)&&E.push(M);V[0].attributes.wit=E.join(" ")}var J=V[0],L="";J.elements&&(L=J.elements[0].text),w.push({text:L,type:"app",app:V,id:"app_"+k,index:C}),C+=1}}g.push(w);for(var R=g,q={},D=0;D<R.length;D++)for(var F=R[D],W=0;W<F.length;W++){var X=F[W];if("app"==X.type){for(var $=X.app,A={},B=!0,H=0;H<$.length;H++){var U=$[H],G=U.elements,K="";if(U.attributes&&(K=U.attributes.wit),null!=G)for(var Q=0;Q<G.length;Q++){var Y=G[Q];""!=K&&(A[K]={text:Y.text,type:U.name})}}B&&(q[X.id]={index:C,wits:A}),C+=1}}this.test6=q,this.test_arr=g}else this.start=!1},close_panel:function(t){var e={};for(var a in this.test5)e[a]=this.test5[a];delete e[t],this.test5=e},test:function(t,e,a){var r={};for(var n in this.test5)r[n]=this.test5[n];if(r[e])delete r[e];else{for(var i={},s=0;s<t.length;s++){var l=t[s],o=l.elements,c="";if(l.attributes&&(c=l.attributes.wit),null!=o)for(var u=0;u<o.length;u++){var p=o[u];""!=c&&(i[c]={text:p.text,type:l.name})}else""!=c&&(i[c]={text:"",type:l.name})}r[e]={index:a,wits:i}}this.test5=r}},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)}},h=p,f=(a("034f"),a("2877")),v=a("6544"),m=a.n(v),d=a("7496"),b=a("8336"),_=a("b0af"),x=a("99d9"),y=a("a523"),g=a("a75b"),w=a("169a"),C=a("132d"),k=a("da13"),S=a("8dd9"),O=a("1f4f"),j=a("2fa4"),V=a("71d9"),T=a("2a7f"),P=Object(f["a"])(h,n,i,!1,null,null,null),z=P.exports;m()(P,{VApp:d["a"],VBtn:b["a"],VCard:_["a"],VCardText:x["a"],VContainer:y["a"],VContent:g["a"],VDialog:w["a"],VIcon:C["a"],VListItem:k["a"],VSheet:S["a"],VSimpleTable:O["a"],VSpacer:j["a"],VToolbar:V["a"],VToolbarTitle:T["a"]});var N=a("8c4f");r["a"].use(N["a"]);var I=[{path:"/",name:"index"}],E=new N["a"]({base:"",routes:I,scrollBehavior:function(){return{x:0,y:0}}}),M=E,J=a("f309");r["a"].use(J["a"]);var L=new J["a"]({}),R=a("c4e8"),q=a.n(R);r["a"].use(q.a),r["a"].config.productionTip=!1,new r["a"]({router:M,vuetify:L,render:function(t){return t(z)}}).$mount("#app")},"8a23":function(t,e,a){}});
//# sourceMappingURL=app.18db1640.js.map